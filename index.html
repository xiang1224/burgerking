<!DOCTYPE html>
<html lang="zh-Hant">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¼¢å ¡ç‹é¤å»³ POS</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gradient-to-br from-yellow-100 to-red-100 min-h-screen flex items-center justify-center p-6">
    <div id="app" class="w-full max-w-6xl bg-white rounded-2xl shadow-xl p-8 grid grid-cols-1 md:grid-cols-2 gap-8">

        <!-- å·¦å´ï¼šé»é¤ -->
        <div>
            <div class="flex items-center justify-between mb-6">
                <h1 class="text-3xl font-extrabold text-red-600">ğŸ” æ¼¢å ¡ç‹é¤å»³ POS</h1>
                <button @click="toggleLayout"
                    class="px-5 py-2 rounded-full bg-gradient-to-r from-blue-500 to-blue-700 text-white font-semibold">
                    åˆ‡æ›ç‰ˆé¢ï¼ˆ{{ layout.toUpperCase() }}ï¼‰
                </button>
            </div>

            <!-- çµ„åˆé¤ -->
            <div class="border rounded-xl p-4 mb-6 bg-yellow-50">
                <label class="flex items-center mb-2">
                    <input type="checkbox" v-model="combo.enabled" class="accent-red-600 mr-2">
                    <span class="font-semibold">è‡ªç”±é…çµ„åˆé¤ï¼ˆ$350ï¼‰</span>
                </label>

                <div v-if="combo.enabled" class="space-y-3 text-sm">
                    <!-- æ¼¢å ¡ -->
                    <select v-model="combo.burger" class="w-full border rounded-lg p-2">
                        <option disabled value="">é¸æ“‡æ¼¢å ¡</option>
                        <option v-for="b in burgers" :key="b.name" :value="b">{{ b.name }}</option>
                    </select>

                    <!-- é»å¿ƒ -->
                    <select v-model="combo.snack" class="w-full border rounded-lg p-2">
                        <option disabled value="">é¸æ“‡é»å¿ƒ</option>
                        <option v-for="s in snacks" :key="s.name" :value="s">{{ s.name }}</option>
                    </select>

                    <!-- ä¸€èˆ¬é£²æ–™ï¼ˆæ’é™¤å‡ç´šé¡ï¼‰ -->
                    <select v-model="combo.drink" class="w-full border rounded-lg p-2">
                        <option disabled value="">é¸æ“‡é£²æ–™</option>
                        <option v-for="d in normalDrinks" :key="d.name" :value="d">{{ d.name }}</option>
                    </select>

                    <!-- å‡ç´šå‹¾é¸ -->
                    <label class="flex items-center">
                        <input type="checkbox" v-model="combo.upgradeEnabled" class="accent-red-600 mr-2">
                        å‡ç´šé£²æ–™
                    </label>

                    <!-- å‡ç´šé¸å–® -->
                    <select v-if="combo.upgradeEnabled" @change="openFlavorModal($event.target.value)"
                        class="w-full border rounded-lg p-2">
                        <option disabled selected value="">é¸æ“‡å‡ç´šç¨®é¡</option>
                        <option v-for="u in drinkUpgrades" :key="u.type" :value="u.type">
                            {{ u.type }} +{{ u.price }}
                        </option>
                    </select>

                    <!-- ä»½æ•¸è¼¸å…¥ -->
                    <div class="flex items-center mb-2">
                        <label class="mr-2 font-semibold">æ•¸é‡ï¼š</label>
                        <input type="number" min="1" v-model.number="combo.qty"
                            class="w-20 border rounded p-1 text-center">
                    </div>

                    <button @click="addCombo"
                        :disabled="!combo.burger || !combo.snack || (!combo.drink && !(combo.upgradeEnabled && combo.upgrade))"
                        class="w-full py-2 bg-red-600 text-white rounded-lg font-semibold">
                        åŠ å…¥çµ„åˆ
                    </button>
                </div>
            </div>

            <!-- å•†å“å€ -->
            <div v-if="layout === 'v1'">
                <template v-for="section in sections" :key="section.title">
                    <h2 class="font-semibold mb-2">{{ section.title }}</h2>
                    <div v-for="item in section.items" :key="item.name" class="flex mb-2">
                        <span>{{ item.name }}ï¼ˆ{{ item.price }}ï¼‰</span>
                        <input type="number" min="0" v-model.number="item.qty"
                            class="ml-auto w-20 border rounded p-1 text-center">
                    </div>
                </template>
            </div>

            <div v-else>
                <template v-for="section in sections" :key="section.title">
                    <h2 class="font-semibold mb-3">{{ section.title }}</h2>
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                        <div v-for="item in section.items" :key="item.name" class="border rounded-xl p-2 text-center">
                            <div class="font-semibold">{{ item.name }}</div>
                            <div class="text-sm text-gray-500">{{ item.price }} å…ƒ</div>
                            <input type="number" min="0" v-model.number="item.qty"
                                class="mt-2 w-full border rounded p-1 text-center">
                        </div>
                    </div>
                </template>
            </div>

            <div class="flex gap-4 mt-4">
                <button @click="calculate" class="flex-1 bg-red-600 text-white py-2 rounded-xl">çµå¸³</button>
                <button @click="reset" class="flex-1 bg-gray-300 py-2 rounded-xl">æ¸…ç©º</button>
            </div>
        </div>

        <!-- æ˜ç´° -->
        <div class="bg-gray-50 rounded-xl p-6">
            <h2 class="text-xl font-bold mb-4 text-center">ğŸ§¾ é»é¤æ˜ç´°</h2>
            <ul class="space-y-2 text-sm">
                <li v-for="item in receipt" :key="item.name" class="flex justify-between">
                    <span>{{ item.name }}</span>
                    <span>{{ item.subtotal }} å…ƒ</span>
                </li>
            </ul>
            <div class="border-t mt-4 pt-4 flex justify-between font-bold">
                <span>ç¸½é‡‘é¡</span>
                <span class="text-red-600">{{ result }} å…ƒ</span>
            </div>
        </div>

        <div class="col-span-full text-center text-xs text-gray-400 mt-6">
            Â© 2026 æœ¬ç³»çµ±ç”±ï½œæšˆèˆ¹ä»”ï½œå°ç¿” è£½ä½œï¼Œåƒ…ä¾›å…§éƒ¨ä½¿ç”¨
        </div>

        <!-- å‡ç´šå£å‘³é¸æ“‡è¦–çª— -->
        <div v-if="showFlavorModal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50">
            <div class="bg-white rounded-xl p-6 w-80">
                <h3 class="text-lg font-bold mb-4 text-center">
                    é¸æ“‡ {{ selectedUpgradeType.type }} å£å‘³
                </h3>

                <div class="space-y-2">
                    <button v-for="f in selectedUpgradeType.flavors" :key="f" @click="selectFlavor(f)"
                        class="w-full py-2 border rounded-lg hover:bg-red-50">
                        {{ f }}
                    </button>
                </div>

                <button @click="cancelFlavor" class="mt-4 w-full text-sm text-gray-500">
                    å–æ¶ˆ
                </button>
            </div>
        </div>

    </div>

    <script>
        const { createApp } = Vue;
        createApp({
            data() {
                return {
                    layout: 'v2',
                    combo: {
                        enabled: false,
                        burger: '',
                        snack: '',
                        drink: '',
                        upgradeEnabled: false,
                        upgrade: '',
                        qty: 1
                    },
                    showFlavorModal: false,
                    selectedUpgradeType: null,
                    selectedFlavor: '',
                    burgers: [
                        { name: 'èœ˜è››äººå ¡', price: 150, qty: 0 },
                        { name: 'ç°å¤ªéƒå ¡', price: 150, qty: 0 },
                        { name: 'ç¾å‘³èŸ¹å ¡', price: 150, qty: 0 },
                        { name: 'å¶ç´ æ¼¢å ¡', price: 150, qty: 0 },
                        { name: 'ä½©ä½©è±¬è‚‰å ¡', price: 200, qty: 0 },
                        { name: 'é»¯ç„¶æ¶ˆé­‚å ¡', price: 150, qty: 0 },
                        { name: 'ä¹³é…ªä¸‰æ˜æ²»', price: 150, qty: 0 }
                    ],
                    snacks: [
                        { name: 'é»ƒé‡‘è„†è–¯', price: 100, qty: 0 },
                        { name: 'å·§å…‹åŠ›ç”œç”œåœˆ', price: 100, qty: 0 },
                        { name: 'è‰è“ç”œç”œåœˆ', price: 100, qty: 0 },
                        { name: 'ç¶“å…¸ç”œç”œåœˆ', price: 100, qty: 0 },
                        { name: 'QQå…§å…§å’©å™—é¤…', price: 200, qty: 0 },
                        { name: 'å·§å…‹å†°ç‚«é¢¨', price: 150, qty: 0 },
                        { name: 'é¦™è‰å†°ç‚«é¢¨', price: 150, qty: 0 }
                    ],
                    drinks: [
                        { name: 'è—è‰²æ€æ¨‚å†°', price: 150, qty: 0 },
                        { name: 'ç¶ è‰²æ€æ¨‚å†°', price: 150, qty: 0 },
                        { name: 'å¯æ¨‚', price: 100, qty: 0 },
                        { name: 'ä½å¡å¯æ¨‚', price: 100, qty: 0 },
                        { name: 'æ‰¾äº‹å¯æ¨‚', price: 100, qty: 0 },
                        { name: 'é›ªé€¼', price: 100, qty: 0 },
                        { name: 'æ°£æ³¡æ°´', price: 100, qty: 0 },
                        { name: 'è˜‹æœæ±', price: 150, qty: 0 },
                        { name: 'è‘¡è„æ±', price: 150, qty: 0 },
                        { name: 'æŸ³æ©™æ±', price: 150, qty: 0 },
                        { name: 'èŠ’æœå†°èŒ¶', price: 200, qty: 0 },
                        { name: 'é³³æ¢¨å†°èŒ¶', price: 200, qty: 0 }
                    ],

                    drinkUpgrades: [
                        {
                            type: 'æ€æ¨‚å†°',
                            price: 15,
                            flavors: ['è—è‰²æ€æ¨‚å†°', 'ç¶ è‰²æ€æ¨‚å†°']
                        },
                        {
                            type: 'å†°èŒ¶',
                            price: 10,
                            flavors: ['èŠ’æœå†°èŒ¶', 'é³³æ¢¨å†°èŒ¶']
                        },
                        {
                            type: 'å†°ç‚«é¢¨',
                            price: 20,
                            flavors: ['å·§å…‹åŠ›å†°ç‚«é¢¨', 'é¦™è‰å†°ç‚«é¢¨']
                        }
                    ],
                    receiptItems: [],  // å–®é»å•†å“
                    receiptCombos: [], // çµ„åˆé¤
                    receipt: [],       // åˆä½µæ˜ç´°
                    result: 0
                };
            },

            computed: {
                normalDrinks() {
                    return this.drinks.filter(d =>
                        !d.name.includes('æ€æ¨‚å†°') &&
                        !d.name.includes('å†°ç‚«é¢¨') &&
                        !d.name.includes('å†°èŒ¶')
                    );
                },
                sections() {
                    return [
                        { title: 'ğŸ” æ¼¢å ¡', items: this.burgers },
                        { title: 'ğŸŸ é»å¿ƒ', items: this.snacks },
                        { title: 'ğŸ¥¤ é£²æ–™', items: this.drinks }
                    ];
                }
            },

            methods: {
                toggleLayout() {
                    this.layout = this.layout === 'v1' ? 'v2' : 'v1';
                },

                addCombo() {
                    let unitPrice = 350;
                    let drinkName = this.combo.upgradeEnabled && this.combo.upgrade
                        ? this.combo.upgrade.name
                        : this.combo.drink.name;

                    if (this.combo.upgradeEnabled && this.combo.upgrade) {
                        unitPrice += this.combo.upgrade.price;
                    }

                    let totalPrice = unitPrice * this.combo.qty;

                    this.receiptCombos.push({
                        name: `${this.combo.burger.name} + ${this.combo.snack.name} + ${drinkName} x${this.combo.qty}`,
                        subtotal: totalPrice
                    });

                    // é‡ç½® combo
                    this.combo = { enabled: false, burger: '', snack: '', drink: '', upgradeEnabled: false, upgrade: '', qty: 1 };

                    // è‡ªå‹•è¨ˆç®—ç¸½é¡
                    this.calculate();
                },

                calculate() {
                    // è™•ç†å–®é»å•†å“
                    this.receiptItems = [];
                    this.sections.forEach(section => {
                        section.items.forEach(item => {
                            if (item.qty > 0) {
                                this.receiptItems.push({
                                    name: item.name,
                                    subtotal: item.price * item.qty
                                });
                            }
                        });
                    });

                    // åˆä½µæ˜ç´°
                    this.receipt = [...this.receiptItems, ...this.receiptCombos];

                    // è¨ˆç®—ç¸½é¡
                    this.result = this.receipt.reduce((t, i) => t + i.subtotal, 0);
                },

                openFlavorModal(typeName) {
                    this.selectedUpgradeType =
                        this.drinkUpgrades.find(u => u.type === typeName);
                    this.showFlavorModal = true;
                },

                selectFlavor(flavor) {
                    this.combo.upgrade = {
                        name: flavor,
                        price: this.selectedUpgradeType.price
                    };
                    this.showFlavorModal = false;
                },

                cancelFlavor() {
                    this.showFlavorModal = false;
                    this.combo.upgrade = '';
                },

                reset() {
                    this.receiptItems = [];
                    this.receiptCombos = [];
                    this.receipt = [];
                    this.result = 0;

                    // é‡ç½®å–®é»å•†å“ qty
                    this.sections.forEach(section => {
                        section.items.forEach(item => item.qty = 0);
                    });

                    // é‡ç½® combo
                    this.combo = { enabled: false, burger: '', snack: '', drink: '', upgradeEnabled: false, upgrade: '', qty: 1 };
                }
            }

        }).mount('#app');
    </script>
</body>

</html>